\chapter{Аналитическая часть}

Чтобы вычислить расстояние Левенштейна вводятся редакционные предписания -- последовательность действий, необходимых для получения из первой строки второй кратчайшим образом. Обычно действия обозначаются так: D (англ. delete) -- удалить, I (англ. insert) -- вставить, R (replace) -- заменить, M (match) -- совпадение.

Цены операций могут зависеть от вида операции (вставка, удаление, замена) и/или от участвующих в ней символов, отражая разную вероятность мутаций в биологии, разную вероятность разных ошибок при вводе текста и т. д. В общем случае:
\begin{itemize}
	\item[--] $w(a,b)$ -- цена замены символа $a$ на символ $b$;
	\item[--] $w(\lambda,b)$ -- цена вставки символа $b$;
	\item[--] $w(a,\lambda)$ -- цена удаления символа $a$.
\end{itemize}

Для решения задачи о редакционном расстоянии необходимо найти последовательность редакционных предписаний, минимизирующую суммарную цену. Расстояние Левенштейна является частным случаем этой задачи при
\begin{itemize}
	\item[--] $w(a,a)=0$;
	\item[--] $w(a,b)=1, \medspace a \neq b$;
	\item[--] $w(\lambda,b)=1$;
	\item[--] $w(a,\lambda)=1$.
\end{itemize}

\clearpage

\section{Рекурсивный алгоритм нахождения расстояния Левенштейна}

Существует проблема взаимного выравнивания строк.

\begin{table}[h]
	\begin{center}
		\caption{\label{tabular:ex} Пример неоптимального выбора расположения строк}
			\begin{tabular}{c|c|c|c|c|c|c|c|c|c|c|c}
				s1 & y & в & л & е & ч & е & н & и & е & " " & " " \\
				\hline
				s2 & p & а & з & в & л & е & ч & е & н & и & е \\
				\hline
				Операции & R & R & R & R & R & M & R & R & R & I & I
			\end{tabular}
	\end{center}
\end{table}

Сумма цен операций равна 10.

Теперь расположим строки относительно друг друга иным образом.
\begin{table}[h]
	\begin{center}
		\caption{\label{tabular:ex2} Пример оптимального выбора расположения строк}
			\begin{tabular}{c|c|c|c|c|c|c|c|c|c|c|c}
				s1 & " " & " " & y & в & л & е & ч & е & н & и & е \\
				\hline
				s2 & p & а & з & в & л & е & ч & е & н & и & е \\
				\hline
				Операции & I & I & R & M & M & M & M & M & M & M & M
			\end{tabular}
	\end{center}
\end{table}

Сумма цен операций равна 3, что и является расстоянием Левенштейна для данных строк.

Проблема решается введением рекуррентной формулы.

Обозначим:
\begin{itemize}
	\item[--] L1 — длина S1 (первой строки);
	\item[--] L2 — длина S2 (второй строки);
	\item[--] S1[1...i] — подстрока S1 длиной i, начиная с первого символа;
	\item[--] S2[1...j] — подстрока S2 длиной j, начиная с первого символа;
	\item[--] S1[i] — i-й символ строки S1;
	\item[--] S2[j] — j-й символ строки S2.
\end{itemize}

Тогда расстояние Левенштейна между двумя строками S1 и S2 может быть вычислено по формуле \ref{eq:D}, где функция $D(S1[1...i], S2[1...j])$ определена как:
\begin{equation}
	\label{eq:D}
	D(S1[1...i], S[1...j]) = \begin{cases}
		0 &\text{i = 0, j = 0},\\
		j &\text{i = 0, j > 0},\\
		i &\text{i > 0, j = 0},\\
		\min \lbrace \\
			\qquad D(S1[1...i], S2[1...j-1]) + 1\\
			\qquad D(S1[1...i-1], S2[1...j]) + 1 &\text{i > 0, j > 0}\\
			\qquad D(S1[1...i-1], S2[1...j-1]) + \\
			\qquad + f(S1[i], S2[j]) &\text(\ref{eq:m})\\
		\rbrace.
	\end{cases}
\end{equation}

а функция \ref{eq:m} определена как:
\begin{equation}
	\label{eq:m}
	f(a, b) = \begin{cases}
		0 &\text{если a = b,}\\
		1 &\text{иначе}.
	\end{cases}
\end{equation}

Рекурсивный алгоритм реализует формулу \ref{eq:D}.
Функция $D$ составлена иcходя следующих соображений:
\begin{enumerate}[label={\arabic*.}]
	\item Для перевода из пустой строки в пустую требуется ноль операций.
	\item Для перевода из пустой строки в строку $a$ требуется $|a|$ операций (вставка), где $|a|$ — длина строки a.
	\item для перевода из строки $a$ в пустую требуется $|a|$ операций (удаление).
\end{enumerate}
Для перевода из строки $S1$ в строку $S2$ требуется выполнить последовательно некоторое количество операций (удаление, вставка, замена) в некоторой последовательности. Последовательность проведения любых двух операций можно поменять, порядок проведения операций не важен. Если $S1', S2'$  -- строки $S1$ и $S2$ без последнего символа соответственно, то цена преобразования из строки $S1$ в строку $S2$ может быть выражена как:
	\begin{enumerate}[label={\arabic*.}]
		\item Сумма цены преобразования строки $S1$ в $S2$ и цены проведения операции удаления (1), которая необходима для преобразования $S1'$ в $S1$.
		\item Сумма цены преобразования строки $S1$ в $S2$  и цены проведения операции вставки (1), которая необходима для преобразования $S2'$ в $S2$.
		\item Сумма цены преобразования из $S1'$ в $S2'$ и цены проведения операции замены (1), предполагая, что $S1$ и $S2$ оканчиваются разные символы.
		\item Цена преобразования из $S1'$ в $S2'$ при условии, что $S1$ и $S2$ оканчиваются на один и тот же символ.
	\end{enumerate}

Минимальной ценой преобразования будет минимальное значение приведенных вариантов.

\section{Матричный алгоритм нахождения расстояния Левенштейна}

Альтернативным подходом для более эффективного вычисления Левенштейна является использование матрицы для сохранения промежуточных значений. Этот подход позволяет избежать повторных вычислений множества значений $D(S1[1...i], S2[1...j])$ при больших значениях $i$ и $j$. Вместо этого алгоритм заполняет матрицу $A_{|S1| + 1,|S2| + 1}$ построчно значениями $D(S1[1...i], S2[1...j])$.

Таким образом, вычисление значения $D(S1[1...i], S2[1...j])$ зависит от значений, сохраненных в матрице $A$. Вместо повторного вычисления, алгоритм может просто обращаться к матрице для получения необходимого значения. Это значительно сокращает количество вычислений и делает алгоритм более эффективным.

Искомое расстояние при этом будет находиться в элементе матрицы $A[i][j]$.

\section{Рекурсивный алгоритм нахождения расстояния Дамерау-Левенштейна}

Исходя из того, что 80\% ошибок при наборе текста приходится на транспозицию (два соседних символа меняются местами), Фредерик Дамерау предложил ввести четвёртую редакторскую операцию -- транспозицию (перестановку).

Обозначим:
\begin{itemize}
	\item[--] L1 -- длина S1 (первой строки);
	\item[--] L2 -- длина S2 (второй строки);
	\item[--] S1[1...i] -- подстрока S1 длиной i, начиная с первого символа;
	\item[--] S2[1...j] -- подстрока S2 длиной j, начиная с первого символа;
	\item[--] S1[i] -- i-й символ строки S1;
	\item[--] S2[j] -- j-й символ строки S2.
\end{itemize}

Тогда расстояние Дамерау-Левенштейна между двумя строками S1 и S2 может быть вычислено по формуле \ref{eq:D}, где функция $D(S1[1...i], S2[1...j])$ определена как:
\begin{equation}
	\begin{small}
	\label{eq:D}
	D(S1[1...i], S[1...j]) = \begin{cases}
		0 &\text{i = 0, j = 0},\\
		j &\text{i = 0, j > 0},\\
		i &\text{i > 0, j = 0},\\
		\min \lbrace \\
		\qquad  D(S1[1...i-1], S2[1...j-1]) + 1\\
		\qquad D(S1[1...i], S2[1...j-1]) + 1 &\text{если (i > 1, j > 1}\\
		\qquad D(S1[1...i-1], S2[1...j]) + 1 &\text{S1[i] = S2[j - 1],}\\
		\qquad D(S1[1...i-1], S2[1...j-1]) + &\text{S1[i - 1] = S2[j]),}\\
		\qquad + f(S1[i], S2[j]) &\text(\ref{eq:m})\\
		\rbrace,
		\\
		\min \lbrace \\
		\qquad D(S1[1...i], S2[1...j-1]) + 1 &\text{иначе,}\\
		\qquad D(S1[1...i-1], S2[1...j]) + 1 \\
		\qquad D(S1[1...i-1], S2[1...j-1]) + \\
		\qquad + f(S1[i], S2[j]) &\text(\ref{eq:m})\\
		\rbrace
	\end{cases}
    \end{small}
\end{equation}

а функция \ref{eq:m} определена как:
\begin{equation}
	\label{eq:m}
	f(a, b) = \begin{cases}
		0 &\text{если a = b,}\\
		1 &\text{иначе}.
	\end{cases}
\end{equation}



\section{Матричный алгоритм нахождения расстояния Дамерау-Левенштейна}

Матричный алгоритм нахождения расстояния Дамерау-Левенштейна реализуется практически идентично матричному алгоритму Левенштейна. Но в данном алгоритме также задействуется элемент матрицы $A[i-2][j-2]$, если возможна транспозиция символов на текущем шаге. 

\section{Рекурсивный алгоритм нахождения расстояния Дамерау-Левенштейна с заполнением матрицы}
\label{sec:recmat}

Рекурсивную реализацию алгоритма Дамерау-Левенштейна можно ускорить, комбинируя рекуррентный и матричный подход.

Для более эффективного вычисления расстояния Левенштейна параллельно можно заполнять матрицу, которая будет использоваться для кеширования уже вычисленных результатов рекурсивных вызовов. В процессе заполнения матрицы рекурсивно вызываются только те вычисления, которые еще не были обработаны. Результаты нахождения расстояния сохраняются в матрице, и если уже обработанные данные встречаются снова, расстояние для них не находится и алгоритм переходит к следующему шагу.

\section*{Вывод}

Алгоритмы Левенштейна и Дамерау-Левенштейна для вычисления расстояния между строками могут быть реализованы как рекурсивно, так и итерационно. Оба алгоритма определяют расстояние между двумя строками путем вычисления минимального количества операций (вставки, удаления и замены символов, а также транспозиции), необходимых для преобразования одной строки в другую.

\pagebreak

